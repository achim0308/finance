{% extends 'returns/base.html' %}

{% block preheader_block %}
{% load finance_filters %}
{% endblock preheader_block%}

{% block title_block %} Main {% endblock title_block %}
{% block body_block %}
<h1>Overview</h1>
{% if account_list %}
<h2><a href="#" onclick="toggle_visibility('seg_account');">Accounts</a></h2>
<div id="seg_account" style="display:block">
  <table class="table table-condensed">
    <thead>
      <tr>
        <th></th>
        <th>Value</th>
      </tr>
    </thead>
    <tbody>
      {% for account in account_list %}
      <tr>
        <td><a href="{% url 'returns:account' account.id %}">{{ account.name }}</a></td>
        <td class="text-right">{{ account_values|lookup:account.id }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endif %}

{% if security_list %}
<h2><a href="#" onclick="toggle_visibility('seg_investments');">Investments</a></h2>
<div id="seg_investments" style="display:block">
  <table class="table table-condensed">
    <thead>
      <tr>
		<th>Kind</th>
        <th>Name</th>
        <th>Description</th>
        <th>Value</th>
      </tr>
    </thead>
    <tbody>
      {% for security in security_list %}
      <tr>
        <th scope="row">{{ security.get_kind_display|title }}</th>
        <td><a href="{% url 'returns:security' security.id %}">{{ security.name }}</a></td>
        <td>{{ security.descrip }}</td>
        <td class="text-right">{{ security_values|lookup:security.id }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endif %}

{% if latest_transaction_list %}
<h2><a href="#" onclick="toggle_visibility('seg_transactions');">Recent Transactions</a></h2>
<div id="seg_transactions" style="display:block">
  <table class="table table-condensed">
    <thead>
      <tr>
		<th>Date</th>
        <th>Kind</th>
        <th>Account</th>
        <th>Security</th>
        <th>Cashflow</th>
      </tr>
    </thead>
    <tbody>
      {% for transaction in latest_transaction_list %}
      <tr>
        <th scope="row">{{ transaction.date }}</th>
        <td><a href="{% url 'returns:transaction' transaction.id %}">{{ transaction.get_kind_display|title }}</a></td>
        <td>{{ transaction.account.name }}</td>
        <td>{{ transaction.security.descrip }}</td>
        <td class="text-right">{{ transaction.cashflow }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% else %}
  <p>No transactions available.</p>
{% endif %}

{% endblock body_block %}
